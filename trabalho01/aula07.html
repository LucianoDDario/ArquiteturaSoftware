<!--Livia Cardozo de Souza, Luciano Dias Dario -->

<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="" />
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <title>Aula07</title>
  </head>

  <body>
    <div class="forms">
      <h1 class="titulo">Formulário</h1>

      <div class="formularioDados">
        <div class="campoNome">
          <label class="verde">Nome completo:</label>
          <input type="text" name="campo" id="nome" required />
        </div>

        <div class="campoEmail">
          <label class="verde">E-mail:</label>
          <input type="email" name="campo" id="email" required />
        </div>

        <div class="campoSenha">
          <label class="verde">Senha:</label>
          <input type="password" name="campo" id="senha" required />
        </div>

        <div class="campoTel">
          <label class="verde">Telefone:</label>
          <input type="tel" name="campo" id="telefone" required />
        </div>

        <div class="campoNasc">
          <label class="verde">Data de Nascimento:</label>
          <input type="date" name="campoNasc" id="data" required />
        </div>
      </div>

      <div>
        <label class="verde">Em que moeda prefere receber o salário?</label>

        <div class="formularioMoeda">
          <div class="colunaMoeda">
            <input type="radio" name="moeda" id="real" /><label for="real">Real</label>
          </div>

          <div class="colunaMoeda">
            <input type="radio" name="moeda" id="dolar" /><label for="dolar">Dolar</label>
          </div>

          <div class="colunaMoeda">
            <input type="radio" name="moeda" id="euro" /><label for="euro">Euro</label>
          </div>

          <div class="colunaMoeda">
            <input type="radio" name="moeda" id="yen" /><label for="yen">Yen</label>
          </div>
        </div>
      </div>

      <div class="formularioExperiencia">
        <label class="verde">Selecione as linguagens que já estudou:</label>

        <div>
          <div class="colunaExperiencia">
            <input type="checkbox" name="linguagem" id="c" />
            <label for="c">C</label>
          </div>

          <div class="colunaExperiencia">
            <input type="checkbox" name="linguagem" id="c++" />
            <label for="c++">C++</label>
          </div>

          <div class="colunaExperiencia">
            <input type="checkbox" name="linguagem" id="html" />
            <label for="html">HTML</label>
          </div>

          <div class="colunaExperiencia">
            <input type="checkbox" name="linguagem" id="java" />
            <label for="java">Java</label>
          </div>

          <div class="colunaExperiencia">
            <input type="checkbox" name="linguagem" id="javascript" />
            <label for="javascript">Javascript</label>
          </div>

          <div class="colunaExperiencia">
            <input type="checkbox" name="linguagem" id="python" />
            <label for="python">Python</label>
          </div>
        </div>
      </div>

      <div class="fotoAtual">
        <label class="verde">Foto atual:</label>
        <div>
          <label for="arquivo" class="botaoFoto">Escolher arquivo</label>
          <input type="file" id="arquivo" class="foto" required hidden />
          <span id="spanArquivo">Nenhum arquivo selecionado</span>
        </div>
      </div>

      <div class="formularioAssuntos">
        <label class="verde">Seus assuntos favoritos:</label>
        <form class="assuntos">
          <select name="assuntos" id="selectAssuntos" multiple required>
            <option value="Artes">Artes</option>
            <option value="Esportes">Esportes</option>
            <option value="Games">Games</option>
            <option value="Música">Música</option>
          </select>
        </form>
      </div>

      <div class="formularioComentarios">
        <label class="verde">Gostaria de fazer comentários?</label>

        <div class="campoComentarios">
          <textarea
            name="comentarios"
            id="comentarios"
            placeholder="Faça seus comentários aqui"
          ></textarea>
        </div>
      </div>

      <div class="botoes">
        <button id="enviar">Enviar</button>
        <button id="limpar">Limpar</button>
      </div>
    </div>
  </body>

  <style>
    body {
      font-family: arial;
      font-weight: bold;
      display: flex;
      justify-content: center;
    }

    .forms {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .formularioDados {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .titulo {
      color: blue;
      display: flex;
      justify-content: center;
    }

    label {
      color: red;
    }

    input {
      font-family: "Courier New", Courier, monospace;
      font-weight: bold;
      color: #bfbebe;
    }

    input[name="campo"]{
      width: 300px;
    }

    option {
      font-family: "Courier New", Courier, monospace;
      font-weight: bold;
      color: #a8a6a6;
    }

    .campoNome {
      display: flex;
      gap: 37px;
    }

    .campoEmail {
      display: flex;
      gap: 109px;
    }

    .campoSenha {
      display: flex;
      gap: 109px;
    }

    .campoTel {
      display: flex;
      gap: 93px;
    }

    input[type="checkbox"],
    input[type="radio"] {
      accent-color: grey;
    }

    .fotoAtual {
      display: flex;
      gap: 80px;
    }

    .foto {
      color: red;
    }

    .botaoFoto {
      color: black;
      border: 1px solid, #4f4f4f;
      border-radius: 2px;
      font-family: Arial, Helvetica, sans-serif;
      font-size: 14px;
      font-weight: 100;
      background-color: #f1f1f1;
      padding-left: 7px;
      padding-right: 7px;
      padding-bottom: 2px;
      padding-top: 2px;
    }

    .botaoFoto:hover {
      background-color: #e5e5e5;
    }

    span {
      font-family: Arial, Helvetica, sans-serif;
      color: red;
    }
    .verde {
      color: green;
    }

    .fotoAtual {
      display: flex;
      flex-direction: row;
    }

    textarea {
      width: 350px;
      height: 80px;
      font-weight: bold;
    }

    .botoes {
      display: flex;
      gap: 108px;
    }
  </style>

  <script>
    const inputArquivo = document.getElementById("arquivo");
    const nomeArquivo = document.getElementById("spanArquivo");
    let fotoBase64 = null;

    inputArquivo.addEventListener("change", function () {
      if (inputArquivo.files.length > 0) {
        const file = inputArquivo.files[0];
        nomeArquivo.textContent = inputArquivo.files[0].name;

        const reader = new FileReader();

        reader.onload = function (e) {
          fotoBase64 = e.target.result;
        };

        reader.onerror = function (e) {
          alert("Erro ao ler o arquivo", e);
        };
        reader.readAsDataURL(file);
      } else {
        nomeArquivo.textContent = "Nenhum arquivo selecionado";
        fotoBase64 = null;
      }
    });

    $(document).ready(function limparTudo() {
      $("#limpar").click(function () {
        $("#nome").val("");
        $("#email").val("");
        $("#senha").val("");
        $("#telefone").val("");
        $("#data").val("");
        $("input[name='moeda']").prop("checked", false);
        $("input[name='linguagem']").prop("checked", false);
        $("#arquivo").val("");
        nomeArquivo.textContent = "Nenhum arquivo selecionado";
        $("#selectAssuntos option:selected").prop("selected", false);
        $("#comentarios").val("");
        $("#selectAssuntos option:selected").prop("selected", false);

        fotoBase64 = null;
      });

      $("#enviar").click(function () {
        const nome = $("#nome").val();
        const email = $("#email").val();
        const senha = $("#senha").val();
        const telefone = $("#telefone").val();
        const dataNascimento = $("#data").val();
        const moeda = $("input[name='moeda']:checked").attr("id");
        const comentarios = $("#comentarios").val();
        var linguagem = [];
        const assunto = $("#selectAssuntos").val();

        $("input[name='linguagem']:checked").each(function () {
          linguagem.push({
            id: $(this).attr("id"),
          });
        });

        if (!nome || !email || !senha || !telefone || !dataNascimento) {
          alert("Preencha todos os campos");
        }

        const regexContemNumero = /\d/;
        const regexDuasPalavras = /^\p{L}+(\s+\p{L}+)+$/u;
        const regexEmailCorreto = /[A-Z0-9._%+-]+@[A-Z0-9-]+.+.[A-Z]{2,4}/gim;
        const regexSenhaCorreta = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z\d]).{10,30}$/;
        const regexTelefoneCorreto = /^\d{2} \d{9}$/;

        if (regexContemNumero.test(nome)) {
          alert("Nome não pode conter número");
        } else if (!regexDuasPalavras.test(nome)) {
          alert("Nome completo precisa de no mínimo duas palavras");
        } else if (!regexEmailCorreto.test(email)) {
          alert("E-mail não está correto");
        } else if (!regexSenhaCorreta.test(senha)) {
          alert(
            "A senha precisa ter no mínimo 10 caracteres, sendo pelo menos 1 número, um caractere especial e uma letra maiuscula"
          );
        } else if (!regexTelefoneCorreto.test(telefone)) {
          alert("O telefone precisa estar no formato 19 999998888");
        } else if (!moeda) {
          alert("Selecione um tipo de moeda");
        } else if (linguagem.length == 0) {
          alert("Selecione pelo menos uma linguagem de programação");
        } else if (comentarios.length == 0) {
          alert("Preencha o campo comentários");
        } else if (fotoBase64 == null) {
          alert("Adicione uma foto");
        } else if (!assunto || assunto.length == 0) {
          alert("Selecione pelo menos um assunto favorito");
        } else {
          const dataEscrita = new Date(dataNascimento + "T00:00:00");
          const dataMinima = new Date("1980-01-01T00:00:00");
          const dataMaxima = new Date("2005-12-31T00:00:00");

          if (dataEscrita < dataMinima || dataEscrita > dataMaxima) {
            alert("A data de nascimento precisa estar entre 01/01/1980 e 31/12/2005");
          } else {
            const pessoa = new Object();
            pessoa.nomeCompleto = nome;
            pessoa.email = email;
            pessoa.senha = senha;
            pessoa.telefone = telefone;
            pessoa.dataNascimento = dataNascimento;
            pessoa.moeda = moeda;
            pessoa.linguagem = linguagem;
            pessoa.comentarios = comentarios;
            pessoa.foto = fotoBase64;
            pessoa.assuntosFavoritos = assunto;

            $.ajax({
              url: "https://jsonplaceholder.typicode.com/posts",
              type: "post",
              dataType: "json",
              contentType: "application/json",
              data: JSON.stringify(pessoa),
              success: function (data) {
                console.log(data);
                alert("Enviado com sucesso");

                $("#nome").val("");
                $("#email").val("");
                $("#senha").val("");
                $("#telefone").val("");
                $("#data").val("");
                $("input[name='moeda']").prop("checked", false);
                $("input[name='linguagem']").prop("checked", false);
                $("#arquivo").val("");
                nomeArquivo.textContent = "Nenhum arquivo selecionado";
                $("#selectAssuntos option:selected").prop("selected", false);
                $("#comentarios").val("");
                fotoBase64 = null;
              },
              error: function (xhr, resp, text) {
                console.log(xhr, resp, text);
                alert("Ocorreu um erro ao enviar os dados");
              },
            });
          }
        }
      });
    });
  </script>
</html>
